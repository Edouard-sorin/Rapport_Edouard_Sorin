[["index.html", "Amélioration de la surveillance épidémiologique du « greening » des agrumes infectés par le Huanglongbing à La Réunion par Spectroscopie Proche Infra-Rouge Mémoire de stage de fin détude pour lobtention du diplôme de Master 2, Ingénieur Agronome, Spécialisation GEEFT - Gestion Environnementale des Écosystèmes et Forêts Tropicales Remerciements", " Amélioration de la surveillance épidémiologique du « greening » des agrumes infectés par le Huanglongbing à La Réunion par Spectroscopie Proche Infra-Rouge Mémoire de stage de fin détude pour lobtention du diplôme de Master 2, Ingénieur Agronome, Spécialisation GEEFT - Gestion Environnementale des Écosystèmes et Forêts Tropicales Auteur - Edouard SORIN Encadrante de stage - Virginie RAVIGNE (CIRAD - UMR PVBMT) Coencadrant - Olivier PRUVOST (CIRAD - UMR PVBMT) Enseignant référent - Eric MARCON (AgroParisTech) Examinateur - Simon TAUGOURDEAU (CIRAD - UMR SELMET) Stage effectué du - 30/09/2020 au 02/04/2021 au - CIRAD-Centre de coopération Internationale en recherche agronomique pour le développement, Pôle de Protection des Plantes, 7 chemin de lIrat, Ligne Paradis, 97410 Saint Pierre- La Réunion Soutenance publique du mémoire le 18 Juin 2021 à AgroParisTech, centre de Montpellier 2021-06-29 Abstract Huanglongbing (HLB) is a bacterial disease causing dieback in citrus fruits. There has been a resurgence of this disease on Reunion Island since 2012, which threatens citrus orchards. The conventional detection techniques for disease surveillance by PCR are expensive, time consuming and cannot be carried out on a large scale. This is where the technology of spectral imaging analysis comes in. This technology is based on the analysis of the spectral signature that a medium emits in response to light exposure. This method is non-destructive, in addition to being relatively inexpensive. The analyzes made it possible to highlight a fairly weak influence of the plots and varieties on the wavelengths where HLB is detected. This makes the effect of HLB detectable without noise and therefore usable for diagnosis. Added to this is a processing of spectral imaging data by machine learning in order to predict the status of trees vis-à-vis the disease within citrus plots. This model is promising with a prediction quality of 92.6% for the Partial Least Squares (PLS) method on a training basis of 8400 reflectance spectra. Remerciements Je tiens à remercier toutes les personnes qui ont contribué au bon déroulement de ce stage : Virginie RAVIGNE, mon encadrante de stage pour son encadrement, sa gentillesse , ses conseils et lautonomie quelle ma laissée au cours de ce stage afin que je développe mes propres axes de recherche sur cette thématique ; Frédéric CHIROLEU, chercheur en biostatistiques, co-auteur de ce rapport, et Thuy-Trang CAO, pour leur grande aide à la réalisation des scripts R et toutes les choses apprises lors de ces rendez-vous ; Olivier PRUVOST, pour son aide lors des analyse qPCR et son encadrement au laboratoire ; Karine BOYER, pour mavoir conseillé et formé aux techniques de laboratoire ; Ismaël HOUILLON, doctorant, pour ses conseils et ses jeux de mots douteux ; Elisa PAYET, technicienne à la FDGDON, pour avoir pris le temps de nous communiquer leurs résultats des détections du HLB et les numéros des agriculteurs ; Raphaël SOLESSE, ainsi que Emmanuel TILLARD, pour leurs conseils, sur le pilotage de drones et la formation à lutilisation des instruments de mesure de spectrométrie ; Louis-Axel EDOUARD RAMBAUT, pour son aide sur les scripts R et ses discussions pertinentes ; Claire MELOT, stagiaire au CIRAD, pour sa bonne humeur et son aide aux analyses de laboratoire tardives ; Le CIRAD, léquipe du 3P de Saint-Pierre et en particulier les agents de lUMR PVBMT (Unité Mixte de Recherche Peuplements Végétaux et Bioagresseurs en Milieux Tropicaux) ; Les stagiaires des Kazz pour leur amitié, les mangues et toutes les choses partagées ensemble qui ont rendu ce stage inoubliable ! "],["introduction.html", "1 Introduction 1.1 Contexte général 1.2 Etat des connaissances sur la maladie 1.3 La résurgence du HLB à la Réunion", " 1 Introduction 1.1 Contexte général La culture dagrumes est la principale culture fruitière au monde (Comte, 2013). Cette culture fait face à une crise sans précédent à léchelle mondiale due au Huanglongbing, couramment appelée HLB ou « greening », une maladie bactérienne qui est la plus dévastatrice des maladies des agrumes (Moriya et al., 2019). Le HLB se propage rapidement et a un impact dévastateur sur la production dagrumes dans les principales régions productrices dagrumes du monde telles que la Chine, le Brésil, lInde et les Etats-Unis (Deng et al., 2020). Cette maladie a été identifiée pour la première fois en Chine il y a un siècle et depuis, 51 des 140 principaux pays producteurs dagrumes ont été infectés par la maladie (Moriya et al., 2019). Cependant, dimportantes régions productrices dagrumes comme la région méditerranéenne et lAustralie sont pour le moment épargnées par cette maladie (Gutierrez et Ponti, 2013). Par ailleurs, Trioza erytreae, un des insectes vecteurs de la maladie a été trouvé dans la péninsule ibérique et pose une menace immédiate de propagation du HLB dans la région méditerranéenne. En Guadeloupe le HLB a décimé la quasi-totalité des vergers et fait chuter la production agrumicole de 70% au début de lannée 2020 (Morillon, 2020). Le HLB est donc devenu un problème déchelle mondiale dont la surveillance est devenue primordiale afin de limiter ses futures propagations (Wang, 2019). Lun des problèmes concernant la surveillance et la lutte contre cette maladie est que les différents travaux de recherche apportant des éléments concernant la lutte contre cette maladie ont été menés sur des paysages homogènes de grandes surfaces de vergers en Californie, en Floride ou au Brésil (Narouei-Khandan et al., 2016). Ces travaux sont donc difficilement applicables à des paysages très hétérogènes comme à la Réunion (Gottwald, 2010). En effet, lîle de la Réunion est un territoire de 2 512 km² qui possède un fort gradient altitudinal, de 0 à 3070m daltitude. Sajoutent à cela les fortes différences dhygrométrie entre la côte au vent à lest et la côte sous le vent à louest (Guilloteau, 2018). Lhétérogénéité éco-climatique étant importante sur ce territoire, la diversité des paysages est donc un aspect fondamental pour la surveillance de cette maladie. Depuis 2012, le département de la Réunion avec son agriculture traditionnelle en agrumiculture est menacé par la résurgence de cette maladie (V. Ravigné, comm. pers.). A la Réunion les vergers dagrumes sont fragmentés et ne représentent une superficie totale que de 300 ha environ (Leung, 2014). Les vergers sont donc répartis en petites parcelles présentes sur des altitudes comprises entre 0 et 1200m (Guilloteau, 2018). Parce que la filière est peu organisée, les vergers dagrumes sont mal répertoriés par les services de lEtat et un travail important de léquipe daccueil ces dernières années a consisté à reconstruire le parcellaire agrumicole en combinant photo-interprétation dimages aériennes et vérifications sur le terrain. On dénombre, à lissue de ce travail 682 vergers dagrumes dont 248 infectés par le HLB (Guilloteau, 2018). Depuis 2015, la DAAF (Direction de lAlimentation, de lAgriculture et de la Forêt) organise une surveillance du parcellaire agrumicole et est chargée de larrachage des plants contaminés. La DAAF a délégué à la FDGDON (Fédération Départementale des Groupements de Défense contre les Organismes Nuisibles) les prélèvements de matériel végétal ainsi que les tests officiels de détection de la maladie. En parallèle, lANSES (Agence Nationale de Sécurité Sanitaire de lAlimentation, de lEnvironnement et du Travail) en charge de la mise au point de méthodes officielles de détection est en coopération avec le CIRAD (Centre de Coopération Internationale en Recherche Agronomique pour le Développement) au travers de son UMR PVBMT (Unité Mixte de Recherche Peuplements Végétaux et Bioagresseurs en Milieu Tropical) pour lamélioration de la détection et de la surveillance de la maladie. 1.2 Etat des connaissances sur la maladie Le HLB est une maladie causée par la bactérie Candidatus Liberibacter associée à trois sous-espèces (americanus, africanus et asiaticus) (Wang, 2019). Cest la sous-espèce Candidatus Liberibacter asiaticus que lon retrouve sur lîle de la Réunion (Aubert, 1989). Cette bactérie de type Gram- (non cultivable) se développe dans les tissus riches en glucides du phloème. Cela va entraîner des dépôts de callose dans le phloème et obstruer les vaisseaux, affaiblissant, à terme, larbre et entraînant sa mort (Bové, 2006). Le HLB est spécifique des agrumes et essentiellement transmis par les psylles qui sont des insectes de lordre des hémiptères. Deux espèces de psylles sont connues pour véhiculer la bactérie responsable de la maladie : Diaphorina citri et Trioza erytreae. Seule la première a jusquici été identifiée dans lépidémie qui sévit actuellement à la Réunion. Ces deux espèces de psylles réalisent une partie de leurs cycles de développement sur les arbres de la famille des Rutacées dont font partie les agrumes cultivés. La bactérie est transmise dun arbre à un autre via la salive de linsecte en se nourrissant de la sève élaborée circulant dans le phloème (Narouei-Khandan et al., 2016). Ce mécanisme de transmission de la maladie peut sétendre sur une distance de 25 à 50 m autour de larbre infecté. Cette distance peut atteindre les 1,5 km en cas de vent, ce qui favorise grandement la dispersion de la maladie (Bové, 2006). Par ailleurs, en plus de la transmission par les psylles, le HLB peut aussi être véhiculé par les greffes et les plantes en pépinière déjà contaminées et vendues aux agriculteurs et particuliers, ce qui fait de la gestion des pépinières un élément clé de la lutte contre la propagation de la maladie. Le HLB affecte tous les agrumes, mais à des degrés de sensibilités différentes. La maladie provoque un dépérissement des arbres avec des symptômes visibles ressemblant à un stress hydrique ou une carence comme le jaunissement asymétrique des feuilles et des flushs (jeunes feuilles, figure 1.1 (Guilloteau, 2018)) (Bové, 2006). Ces symptômes traduisent un dépérissement de larbre avec des fruits petits et de forme asymétrique (Gottwald, 1989). Figure 1.1: Symptôme du HLB sur flush, feuille, fruit et sur larbre Cependant, les symptômes ne permettent pas lidentification de la maladie avec certitude (Gottwald, 1989). En effet, un jaunissement des feuilles peut également être causé par des carences en zinc ou en magnésium (Aubert, 1989). Par ailleurs, la difficulté de la détection de cette maladie réside en partie dans la période de latence qui peut durer 6 à 12 mois et durant laquelle les arbres sont parfaitement asymptomatiques tout en transmettant la maladie (Bové, 2006). Il a été montré que dans un verger avec 30% darbres présentant des symptômes, 50% des arbres sont déjà infectés (Bové, 2006). De plus, il est pour le moment difficile pour les biologistes de bien comprendre le HLB. Les défis actuels résident principalement dans le fait que Candidatus Liberibacter ne peut être cultivée par aucune méthode in vitro en laboratoire. Par conséquent, les analyses moléculaires et génétiques traditionnelles ont une portée limitée pour létude de cette bactérie (Wang, 2019). 1.3 La résurgence du HLB à la Réunion Le HLB avait fait lobjet dune importante campagne darrachage dans les années 1970-1980 en parallèle dune lutte chimique basée sur des produits aujourdhui interdits (notamment des antibiotiques). Ces méthodes accompagnées dune lutte biologique et dun replantage de plants sains ont permis déradiquer cette première épidémie, une réussite unique au monde (Gottwald, 1989). La lutte biologique a reposé sur lintroduction de parasitoïdes des psylles permettant un contrôle des populations de psylles vecteurs de la maladie, encore actifs aujourdhui (Aubert et al., 1996). Cependant, depuis 2012, de nouveaux cas de HLB ont été observés sur lîle. Les parasitoïdes étant toujours présents, aucune pullulation de psylles nest relevée et cest uniquement D. citri qui est observé (Guilloteau, 2018). Si la cause de cette résurgence ne vient pas dune pullulation de la population de psylles, elle pourrait provenir de vergers comportant des arbres malades non arrachés lors de la première épidémie, dun relâchement des pratiques en pépinière ou dune introduction accidentelle (Guilloteau, 2018). En labsence de traitement, larrachage précoce des arbres malades est pour linstant le moyen le plus efficace de lutte contre cette épidémie. Cependant, cette méthode est coûteuse en moyens humains et financiers. Larrachage lui-même est une procédure complexe et après replantation, un verger ne rentre en production quau bout de plusieurs années (4 à 6 ans), ce qui constitue un manque à gagner important. Les aides financières sont très limitées et ne concernent actuellement que la replantation. Dès lors, lacceptabilité de la lutte par arrachage est mauvaise. De plus, la technique officielle de détection et surveillance de la maladie par PCR est coûteuse, de réalisation laborieuse et peut donc difficilement être déployée à grande échelle. De ce fait, la stratégie de surveillance officielle actuelle qui est danalyser 60 arbres à lhectare ne permet pas aux agriculteurs de savoir précisément le statut de chaque arbre dans leur parcelle, ce qui diminue encore lacceptabilité des mesures darrachage. Permettre aux agriculteurs de disposer dune information sur le statut de chaque arbre dans leur parcelle est un levier essentiel pour les amener à prendre les décisions difficiles que lépidémie leur impose. Dautres moyens de surveillance doivent donc être mis en place. Cest dans ce contexte quintervient la technologie de lanalyse par imagerie spectrale. Cette technologie se base sur lanalyse de la signature spectrale mesurée en réflectance quémet un support en réponse à une exposition lumineuse (Sankaran et al., 2013). Cette technologie présente plusieurs avantages prometteurs pour la détection du HLB. En effet, cette méthode est non destructive pour le support traité, est relativement peu coûteuse par rapport à la surface couverte et lefficacité de lanalyse est importante à condition de trouver un calibrage optimal pour détecter la maladie (Sankaran et Ehsani, 2011). Réalisée par des spectromètres à main, cette technique pourrait en principe permettre daugmenter significativement les cadences de détection de la maladie et ainsi fournir à bas coût une information complète aux agriculteurs touchés quant à létat de leur verger. Des tentatives de détecter le HLB par ses signatures spectrales existent dans la littérature scientifique (Sankaran et Ehsani, 2011) et elles sont encourageantes mais le contexte réunionnais est particulier. Les nombreuses variétés locales nont jamais été testées dans la littérature, même les plus importantes (tangor, mandarine zanzibar, orange navel, citron quatre saisons) car les recherches sont principalement concentrées sur les citronniers, les orangers et les mandariniers (Sankaran et Ehsani, 2011) (Deng et al., 2020). Comme les agrumes sont souvent une culture secondaire dans des exploitations centrées sur une autre culture (canne, maraîchage), les arbres sont souvent cultivés de façon non optimale, peu technique et donc peuvent souffrir de carences nutritives et de déficit hydrique. Ces éléments font que les signatures spectrales du HLB pourraient être moins claires à la Réunion que dans les conditions testées ailleurs. Au cours de ce stage, je répondrai ainsi à la question suivante : Peut-on développer une méthode de la télédétection par imagerie spectrale fiable pour améliorer la surveillance épidémiologique du Huanglongbing (HLB) à La Réunion ? Lobjectif global va donc être de prédire le statut positif ou négatif au HLB des arbres directement avec des outils de spectrométrie. Pour résoudre cette problématique, je traiterai les objectifs spécifiques suivants : Les différentes parcelles et variétés analysées ont elles une influence sur les résultats visant à prédire létat sanitaire des arbres ? Quelles longueurs donde sont les plus discriminantes pour la recherche de la maladie par spectrométrie ? Peut-on connaître létat sanitaire dun arbre via une analyse par spectrométrie ? Sous quel degré de précision ? "],["matériel-et-méthodes.html", "2 Matériel et Méthodes 2.1 Identification de la maladie 2.2 Choix des arbres 2.3 Spectroscopie à main 2.4 Traitement des données par analyses statistiques et apprentissage supervisé 2.5 Forêts Aléatoires (RF) 2.6 Machine à Vecteurs de Support (SVM) 2.7 Régression par les Moindres Carrés Partiels (PLS) 2.8 Performance des classifications 2.9 Amélioration du protocole de terrain", " 2 Matériel et Méthodes 2.1 Identification de la maladie Pour la mise au point de la méthode, les feuilles analysées doivent avoir un statut connu vis-à-vis de la maladie. Pour ce faire, la méthode de détection par PCR (Polymerase Chain Reaction) est pour linstant la plus utilisée pour surveiller lévolution de la maladie. Cette méthode permet de détecter lADN de la bactérie à partir déchantillons de feuilles (Gottwald, 2010). Linconvénient de cette méthode est quelle ne permet pas le traitement dun volume important déchantillons et ne donne pas une réponse immédiate sur le prélèvement effectué sur le terrain. La PCR est une technique reconnue de multiplication de lADN dun échantillon. Le but est de dupliquer les échantillons dADN prélevés à chaque cycle de réaction via lADN polymérase. Ainsi, avec un seul brin dADN de départ, des millions de répliques sont produites à chaque cycle de réplication. La qPCR repose sur le même principe avec des améliorations de la technique de départ. Le principe est toujours de multiplier lADN de léchantillon, mais avec cette fois une quantification du nombre de cycles PCR nécessaires à la détection de la maladie. Le nombre de cycles de réplication ou Cycle Threshold (CT) correspond au nombre de cycles PCR à partir duquel le produit de la PCR est détectable. Ainsi, plus le CT est faible plus il y a dADN présent initialement et inversement. Les échantillons sains et malades peuvent donc être distingués selon leur valeur de CT selon un seuil fixé. La méthode officielle actuelle basée sur la PCR classique est actuellement en cours de remplacement par une méthode basée sur la qPCR et qui utilisera le seuil de 36 cycles de détection maximum pour identifier un échantillon comme étant porteur de la maladie. Cest ce seuil de 36 cycles ou CT36 qui sera utilisé dans cette étude pour statuer de létat malade ou sain des arbres. Chaque échantillon est testé 3 fois (on parle de triplicats techniques) et chaque plaque de 96 puits de qPCR contient trois témoins négatifs et deux témoins positifs. Lorsque les témoins donnent des résultats inattendus ou que les triplicats ne sont pas cohérents, les échantillons sont repassés. 2.2 Choix des arbres Le choix des parcelles échantillonnées a été conditionné par la recherche dun équilibre entre les arbres malades et sains sur chaque parcelle basée sur les données de la surveillance officielle et du Cirad. Le défi est que les statuts des arbres ne sont pas connus à lavance et il peut être compliqué de faire un design équilibré en amont de la récolte de données. Lobjectif a donc été dans un premier temps de trouver les agriculteurs qui possèdent les trois variétés dagrumes sur lesquelles se base cette étude, à savoir les citrons (Citrus limon), les mandarines zanzibar (Citrus reticulata) et les tangors (Citrus reticulata x sinensis). Dans un deuxième temps, pour chacun de ces agriculteurs il a fallu identifier précisément le statut des arbres. Concernant les caractéristiques altitudinales et pluviométriques des parcelles, celle de Mr Hoarau et Mr Pothin échantillonnées à Petite-Ile sont comprises dans une échelle de pluviométrie identique la parcelle de Mr Gonthier échantillonnée dans les hauts du Tampon à savoir entre 1430 et 1680 mm de pluie par an (Equipe Artists - UR AïDA, 2021). Leurs altitudes respectives sont cependant très différentes avec une différence de 1000 m et plus entre la parcelle du Tampon et les autres (figure 2.1). La parcelle de Mr Barret située au niveau de la mer est la parcelle qui reçoit le moins de précipitations avec seulement 930 à 960 mm de pluie par an (Equipe Artists - UR AïDA, 2021). Figure 2.1: Carte présentant les parcelles échantillonnées, leurs dates de prélèvement ainsi que la pluviométrie et les altitudes Léchantillonnage a commencé dans la commune de Petite-Île, qui est la plus grosse zone de production dagrumes de lîle (environ 25% de la surface en agrumes) (Guilloteau, 2018). Cette zone est aussi très touchée par le HLB (près de deux parcelles sur trois) avec par conséquent, des prospections importantes de la part de la DAAF et de la FDGDON qui fournissent des données précieuses pour léchantillonnage. Les parcelles de Mr Hoarau et Mr Pothin échantillonnées à Petite-Île possèdent les trois variétés recherchées mais ont une répartition différente entre les arbres malades et sains. Dans la parcelle de Mr Hoarau léchantillonnage sest basé sur une première cartographie des statuts HLB des arbres réalisée dans le cadre dune expérimentation de la FGDGON pour le développement dune autre méthode moléculaire. 42 arbres ont ainsi été sélectionnés dont 19 arbres se sont révélés sains et 23 arbres se sont révélés infectés par le HLB (figure 2.2). Figure 2.2: Échantillonnage réalisé dans la parcelle de Mr Hoarau en 2021 A linverse dans la parcelle de Mr Pothin, léchantillonnage des arbres sest basé sur les dires dexpert de lagriculteur et trois arbres sains pour 39 arbres infectés par le HLB ont été trouvés (figure 2.3). Figure 2.3: Échantillonnage réalisé dans la parcelle de Mr Pothin en 2021 La parcelle de Mr Barret située à Saint Pierre et constituée uniquement de citronniers a été échantillonnée de manière exhaustive. Cette parcelle fut la plus analysée en laboratoire. Les 156 arbres de la parcelle ont dabord été regroupés par pools de 5 puis certains arbres ont été analysés individuellement. Au final 10 citronniers sains et quatre infectés par le HLB ont été trouvés (figure 2.4). Figure 2.4: Échantillonnage réalisé dans la parcelle de Mr Barret en 2021 A lissue de cet échantillonnage, un grand nombre darbres infectés chez Mr Pothin et Barret ont été trouvés, il y avait donc un déficit darbres sains. La parcelle de Mr Gonthier située au Tampon a donc été trouvée pour pallier à ce déficit. Cette parcelle compte une répartition égale entre les trois variétés et dont des lots darbres ont été testés négatifs aux HLB en novembre 2020 lors de la surveillance officielle. Pour chaque variété 14 arbres ont été échantillonnés (figure 2.5) afin de rééquilibrer lensemble du jeu de données. Par manque de temps, ces arbres nont pas été re-testés en qPCR et ont été considérés comme négatifs. Cet échantillonnage nest pas idéal, dans la mesure où les facteurs agriculteur et variété ne sont pas croisés, et une attention particulière sur ce point devra être portée dans linterprétation des résultats. Figure 2.5: Échantillonnage réalisé dans la parcelle de Mr Gonthier en 2021 Au final, au cours de cette étude 140 arbres ont été échantillonnés et numérotés de A1 à T7. 2.3 Spectroscopie à main Lobjectif de lutilisation de la spectroscopie est la discrimination des arbres sains et malades de façon rapide et clairement identifiable en passant loutil de détection sur la parcelle. La détection de la maladie sur les plantes repose sur la capacité des feuilles à absorber, réfléchir ou transmettre la lumière dans différentes longueurs donde mesurées en nanomètre (nm). Ces caractéristiques sont liées à la composition biochimique des feuilles. Les variations de mesure de spectre peuvent donc être expliquées dans les différents domaines du spectre par la teneur en pigment des feuilles dans le visible (400-750 nm), par la structure cellulaire avec lessentiel des vaisseaux dont le phloème dans le proche infrarouge (750-1250 nm) et par la teneur en eau dans le Short-wave infrared ou SWIR (1250-2500 nm) comme indiqué sur la (figure 2.6 (De Blomac, 2014)) (Comar, 2013). Les bandes spectrales du visible (bleu, vert, rouge, red-edge) sont les plus utilisées dans la détection de maladie des feuilles (Mishra et al., 2007). La qualité des résultats dépend de la résolution du capteur utilisé. Dans le visible (400-750 nm), la coloration des feuilles est due à la teneur en chlorophylles, caroténoïdes et anthocyanes. Les chlorophylles (de type a et b) captent la lumière dans des longueurs dondes correspondant au bleu et au rouge. Les caroténoïdes captent la lumière exclusivement dans le bleu et les anthocyanes la captent exclusivement dans le vert. Vers la fin du domaine visible (700 nm) il ny a plus de captage de lumière aussi important et la lumière est quasiment entièrement réfléchie dans cette zone appelée red edge. Ensuite, la zone du proche infrarouge (750-1250 nm) correspond principalement à la structure cellulaire interne des feuilles qui est aussi peu affectée en cas de maladie. Cette zone est utile pour la discrimination des feuilles entre feuillus et résineux qui ont des structures de tissus différentes. Enfin, dans le SWIR (1250-2500 nm), cest principalement la teneur en eau des feuilles qui est mesurée. Plus la réflectance est faible, plus la teneur en eau est grande, ce qui est utile pour caractériser un stress hydrique chez la plante (Albetis de la Cruz, 2018). Figure 2.6: Schéma de la variation de la réflectance de la végétation Au cours de cette étude, la détection du statut infecté en HLB des arbres va être réalisé par la méthode de la Spectroscopie Proche Infra Rouge (SPIR) à main qui est catégorisée comme étant de la proxidétection (Albetis de la Cruz, 2018). Dans le cas de la proxidétection, lacquisition des données se fait par contact direct ou à quelques centimètres de lobjet cible à léchelle de la feuille ou de la plante (figure 2.7). Figure 2.7: Schéma dapplication des capteurs optiques (Source personnelle) Ainsi, pour lacquisition des données, un spectromètre de terrain (ASD fieldspec Pro) a été utilisé en laboratoire (figure 2.8). Lappareil est utilisé afin de mesurer la réflectance, une mesure correspondant à la proportion (comprise entre 0 et 1) de lumière réfléchie par la surface dun matériau qui est ici une feuille dagrume (Comar, 2013). Afin de mesurer cette réflectance, la feuille disposée sur un disque blanc en Spectralon® qui renvoie quasiment toute la lumière transmise. Cette lumière transmise par lappareil traverse dabord la feuille puis est réfléchie et retraverse la feuille avant datteindre le capteur. Le Spectralon® est régulièrement nettoyé au papier de verre pour conserver sa valeur de réflectance constante au cours du temps. De plus, les mesures sont réalisées à température ambiante et un blanc est effectué toutes les 15 minutes en réalisant une mesure de SPIR sur le support en Spectralon® seul. Lappareil mesure une bande de longueur donde allant de 350 à 2500 nm, la courbe caractérisant la réflectance en fonction des longueurs donde mesurées est appelée spectre de réflectance (Comar, 2013). Pour chaque mesure, le spectre de réflectance correspond à une moyenne de 50 mesures de réflectance effectuées par lappareil entre 350 et 2500 nm. Figure 2.8: Photographie dun spectromètre proche infrarouge à main Sur chaque arbre 10 feuilles sont prélevées de manière aléatoire autour de larbre. Le nombre de 10 feuilles à échantillonner provient dun compromis entre le temps danalyse de ces feuilles et de la précision des résultats recherchés. Ce compromis naurait pas pu être possible sans les travaux dun précédent stagiaire, Nathan Créquy qui avait prélevé trois lots de 10 feuilles sur 14 arbres échantillonnés et sur lesquelles des tests sur la baisse de précision ont pu être effectués avant daboutir au nombre idéal de feuilles à prélever (Créquy, 2020).Sur chacune des 10 feuilles prélevées par arbre, six mesures de réflectance sont réalisées afin davoir des spectres de réflectance issus des différentes zones de la feuille. Ce nombre de mesures optimal a été calculé en amont via les données issues de létude de Nathan Créquy qui avait 10 mesures SPIR par feuille et dont les paramètres de précision furent comparés au moyen de tests statistiques pour chaque mesure effectuée par feuille (Créquy, 2020).En fonction des longueurs donde étudiées, les capteurs utilisés sont différents et regroupés en deux catégories, les capteurs multispectraux et hyperspectraux. Les capteurs multispectraux permettent denregistrer des bandes spectrales qui ne sont pas contiguës et qui peuvent être ciblées, par exemple : le proche infrarouge, le bleu, le rouge et le vert. A linverse, les capteurs hyperspectraux enregistrent plus ou moins toutes les bandes spectrales (en fonction de la résolution de lappareil) de façon contiguë dans un intervalle de longueur donde compris entre 350 et 2500 nm (Bertaux, 2015). Au cours de cette étude, seul le capteur hyperspectral sera utilisé sur la partie SPIR avec six mesures SPIR par feuille sur les 10 feuilles prélevées par arbre. Le jeu de données (annexe 1) est donc composé des 140 arbres échantillonnés soit 1400 feuilles échantillonnées et analysées en SPIR. Cependant, le nombre réel de données comprenant les 6 répétitions SPIR par feuilles échantillonnées est de 8400. 2.4 Traitement des données par analyses statistiques et apprentissage supervisé Tous les traitements statistiques sont réalisés sous R (R Core Team, 2021). Les données utilisées pour les analyses sont les valeurs de réflectance issues de la SPIR à main allant de 350 à 2500 nm. Dans un premier temps, lobjectif va être de caractériser les sources de variations des spectres de réflectance, et en particulier, linfluence des parcelles et des variétés sur ces derniers. Ainsi pour chaque longueur donde, une décomposition de la variance est mise en uvre via une ANOVA à un facteur où la variable expliquée est la réflectance observée pour cette longueur donde et la variable explicative est la variété ou la parcelle. Cette analyse produit pour chaque longueur donde une valeur du F de Fisher correspondant au rapport entre la variance intermodalités (entre parcelles ou entre variétés) et la variance résiduelle (au sein des parcelles ou des variétés). Plus le F de Fisher est élevé, plus la variable testée (parcelle ou variété) affecte la réflectance. Dans un second temps, une ANOVA à trois facteurs (statut HLB, variété, parcelle) est réalisée afin de montrer linfluence du statut HLB en interaction avec la variété et la parcelle sur le spectre de réflectance global. Une fois démontrée linfluence ou la non-influence de ces variables de nuisance et leffet qua le statut HLB sur le spectre de réflectance, il est possible denvisager une prédiction sur le statut HLB des arbres à partir des valeurs de réflectance. Pour ce faire, trois types de méthodes de classification par apprentissage supervisé ont été mises en uvre : les forêts aléatoires (RF pour « Random Forest» ), la machine à vecteurs de support (SVM pour « Support Vector Machine ») et la régression par les moindres carrés partiels (PLS pour « Partial Least Square »). Un algorithme dapprentissage supervisé se compose à la fois de données dentrée training set (75% de la base dapprentissage) et de données cibles test set (25% de la base dapprentissage) (Tuszynski, 2020). Les données dentrée comprennent des spectres de réflectances associés à un statut HLB. Elles permettent à lalgorithme de « sentrainer » à reconnaître le statut HLB des arbres à partir des spectres de réflectance. Les données cibles sont composées de spectres pour lesquels le statut HLB est connu mais ne peut être utilisé par lalgorithme car ces données sont utilisées pour la vérification et pour éviter la redondance dutilisation dune donnée dans lapprentissage. Elles permettent de mesurer la performance de lalgorithme. Après sêtre assuré de la bonne performance de lalgorithme, on peut lutiliser pour prédire le statut HLB darbres dont on ne dispose que du spectre de réflectance (Knaus, 2015). 2.5 Forêts Aléatoires (RF) Les RF est une technique utilisant un algorithme dapprentissage supervisé couplé avec un arbre de décision (Liaw et Wiener, 2002) (Borkovec et Madin, 2019). Un arbre de décision est une construction de choix souvent binaire qui permet de prendre une décision. Cet algorithme permet de créer une forêt darbres de décision qui permet daméliorer la généralisation (sur un paramètre recherché) de lensemble du modèle. La RF combine la simplicité de lecture des arbres de décision ainsi que la robustesse de lapprentissage supervisé qui améliore la précision de la prédiction (Moutarde, 2017). La première étape de la construction du RF est la création dun jeu de données pour chaque arbre de décision (figure 2.9 (Moutarde, 2017)). Ce jeu de données se compose des lignes des données originelles piochées aléatoirement (la même ligne pouvant être sélectionnée plusieurs fois comme la ligne 2 de lexemple en rouge). Ce procédé augmente la variété des arbres de décision ce qui rend lalgorithme encore plus robuste (Moutarde, 2017). Figure 2.9: Schéma 1 de construction dun jeu de données dun arbre de décision en RF La deuxième étape va être la création de chaque arbre de décision sur une partie différente (aléatoire et non exclusive) des données et des variables à lintérieur de leurs jeux de données (figure 2.10, rectangles de couleurs (Moutarde, 2017)). Lintérêt est davoir des estimateurs différents dans chaque arbre de décision pour avoir un cheminement différent (Moutarde, 2017). Figure 2.10: Schéma 2 de construction dun arbre de décision en RF La troisième étape consiste à répéter létape 1 et 2 afin de créer autant darbres de décision que lon souhaite dans le but dobtenir un ensemble (forêt) darbres de décision générés aléatoirement (figure 2.11 (Moutarde, 2017)). Le résultat de la RF va correspondre à la moyenne des décisions de lensemble des arbres pour lélément recherché. Figure 2.11: Schéma de construction dune Forêts Aléatoire 2.6 Machine à Vecteurs de Support (SVM) La SVM est aussi un algorithme dapprentissage supervisé qui permet de faire des prédictions sur des variables qualitatives ou quantitatives (Meyer et al., 2020). Lobjectif du SVM va consister à séparer deux classes de données, ici (infecté ; sain) pour pouvoir ensuite établir une généralisation dans la prédiction quand on ne connaîtra pas la nature de léchantillon (infecté ; sain). Pour séparer ces deux classes, lidée est de maximiser les distances entre les échantillons avec un hyperplan séparateur (appelé aussi « support vector ») (figure 2.12 (Cortes et Vapnik, 1995)). Figure 2.12: Schéma de construction dun hyperplan dans le cadre du SVM Lapprentissage supervisé va permettre de déterminer léquation de lhyperplan qui séparera les jeux de données des individus sains de ceux des malades. Cela va ensuite permettre la prédiction pour les jeux de données à tester. 2.7 Régression par les Moindres Carrés Partiels (PLS) Pour finir la PLS est une méthode statistique permettant de traiter une variable binaire à expliquer (ici le statut HLB infecté ou sain) à partir de variables explicatives nombreuses (ici les mesures de réflectance pour chaque longueur donde) (Mevik et al., 2020). Lidée derrière la régression PLS est de créer, à partir dun tableau avec n observations (les statuts HLB) décrites par X variables explicatives (réflectances pour chaque longueur donde), un ensemble de h composantes correspondant aux fonctions de chaque réflectance (Tenehaus, 1999). Cette méthode consiste à rechercher dans un premier temps des composantes h, expliquant au mieux à la fois les variables explicatives X et les variables à expliquer Y. Les équations de régression PLS sont ensuite obtenues en régressant chaque variable Y sur les composantes h, puis en exprimant ces régressions en fonction des variables X dorigine (figure 2.13 (Tenehaus, 1999)). Figure 2.13: Tableau représentant les coefficients de régression en fonction de X et Y Lapprentissage supervisé va permettre de déterminer les équations de régression PLS nécessaires à prédire les jeux de données à tester. 2.8 Performance des classifications En apprentissage supervisé la matrice de confusion mesure la qualité dun système de prédiction (table 2.1). Table 2.1: Matrice de confusion Négatif confirmé Positif confirmé Négatif prédit Vrai Négatif (VN) Faux Négatif (FN) (Erreur de type 2) Positif prédit Faux positif (FP) (Erreur de type 1) Vrai positif (VP) De cette matrice, plusieurs paramètres de performance sont calculés dont : La qualité de la prédiction (Accuracy) = VP + VN / VP + VN + FN + FP met en évidence les erreurs de la prédiction quelles soient de type 1 ou de Type 2 La précision (Precision) = VP / VP + VP met en évidence les erreurs de type 1 Lerreur de type 1 est problématique dans le cadre de la maladie, car elle implique larrachage dun arbre sain alors prédit comme étant positif au HLB La sensibilité (Sensitivity) = VP / VP + FN met en évidence les erreurs de type 2 Lerreur de type 2 impacte quant à elle la détection de la maladie, larbre est prédit comme étant négatif à la maladie alors quil est en réalité malade. Ces paramètres permettent de rendre compte de lefficacité de la prédiction et de pouvoir choisir la meilleure méthode de prédiction. Ces méthodes ont été choisies à partir de la bibliographie où la qualité de la prédiction est par exemple de 85% pour SVM dans larticle de Sindhuja Sankaran (Sankaran et al., 2013) et 96.4% pour PLS dans larticle de Xiaoling Deng (Deng et al., 2020). 2.9 Amélioration du protocole de terrain Afin daméliorer le protocole de terrain pour de futures analyses, la question de savoir sil était possible dalléger le protocole de SPIR à main (i.e., faire moins de feuilles par arbre, moins de mesures de réflectance par feuille) sans perdre en performances de classification sest posée. Pour ce faire, 100 jeux de données ont été simulés et dégradés par rééchantillonnage dans le vrai jeu de données et analysés avec les trois méthodes statistiques présentées. "],["résultats.html", "3 Résultats 3.1 Influence du lieu déchantillonnage et des variétés sur le spectre de réflectance global 3.2 Effet du statut HLB sur les spectres de réflectance 3.3 Lapproche par arbre de décision 3.4 Comparaison des performances des 3 méthodes de prédiction du statut HLB à partir des spectres réflectance 3.5 Prédiction du statut HLB par Régression par les Moindres Carrés Partiels (PLS) 3.6 Amélioration du protocole de terrain pour le choix du nombre de feuilles par arbre 3.7 Amélioration du protocole de terrain pour le choix du nombre de mesures de réflectance par feuille", " 3 Résultats 3.1 Influence du lieu déchantillonnage et des variétés sur le spectre de réflectance global Dans un premier temps, il est intéressant dobserver les données brutes des spectres de réflectance en fonction de leurs variétés. La figure 2.1 montre les spectres de réflectance moyens des variétés citron (en vert), tangor (en orange) et zanzibar (en violet) (figure 3.1). Figure 3.1: Spectre moyen en fonction de la variété pour les arbres négatifs aux HLB Les spectres moyens des variétés échantillonnées ne semblent pas avoir de comportements significativement différents suivant les variétés sur lensemble des longueurs donde. En complément, le calcul du F de Fisher via lANOVA est donc mis en uvre afin de montrer un effet potentiel du lieu déchantillonnage et des variétés sur le spectre de réflectance global (figure 3.2). Figure 3.2: Valeur du F de Fisher pour chaque longueur donde montrant linfluence du facteur variété sur le spectre de réflectance global Linfluence des variétés sur les spectres de réflectance est importante à partir de 1400 nm avec un maximum à 1420 nm (valeur F = 230). Ce maximum est suivi de deux autres pics à F = 200 à 1800 nm et 2300 nm, tous compris dans la partie du spectre correspondant aux infrarouges courtes longueurs donde. Concernant linfluence de la parcelle sur le spectre de réflectance global, celle-ci a une forte influence (figure 3.3). Figure 3.3: Valeur du F de Fisher pour chaque longueur donde montrant linfluence du facteur parcelle sur le spectre de réflectance global En effet, dans le Red edge linfluence du facteur parcelle est à son maximum à 771 nm (valeur F = 875) et a une influence qui reste assez élevée (autour de F = 625) autour des longueurs donde 1500 nm et 2100 nm. 3.2 Effet du statut HLB sur les spectres de réflectance La répartition des différentes variétés dans le jeu de données en fonction de leurs statuts HLB est assez équilibrée (table 3.1). Table 3.1: Répartition des variétés dans le jeu de données Citron.Negatif 25 Citron.Positif 24 Tangor.Negatif 23 Tangor.Positif 23 Zanzibar.Negatif 25 Zanzibar.Positif 20 Total 140 La figure 2.4 montre les spectres de réflectance moyens des arbres positifs au HLB (en rouge) et des arbres négatifs (en vert). On voit des différences nettes de spectre en fonction du statut HLB (figure 3.4). Figure 3.4: Spectre moyen en fonction du statut HLB des arbres Sur certaines parties du spectre des différences de réflectance apparaissent encore plus nettement (figure 3.5). Figure 3.5: Spectres individuels darbres positifs (en rouge) et négatifs (en vert) au HLB pour les longueurs donde de 400 à 680 nm Sur les longueurs donde de 400 à 680 nm les arbres positifs au HLB ont une réflectance légèrement plus élevée que les arbres sains. Par ailleurs, une séparation moins nette sobserve dans la tranche de longueurs donde comprise entre 700 et 1400 nm (figure 3.6). Figure 3.6: Spectres individuels darbres positifs (en rouge) et négatifs (en vert) au HLB pour les longueurs donde de 700 à 1400 nm La différence qui paraissait importante sur la figure 2.1 est à nuancer si lon sintéresse aux spectres individuels. En effet, il ne semble pas se dégager de tendance claire vis-à-vis du statut sur cette partie du spectre. Cest pourquoi il est difficile daffirmer avec certitude leffet de la maladie sur les spectres de réflectance en fonction du statut HLB en utilisant seulement les données brutes. Ainsi, il est intéressant de savoir sil y a une influence de la maladie sur les spectres de réflectance et sur quelles longueurs donde se situe cet effet (figure 3.7). Figure 3.7: Valeur du F de Fisher montrant linfluence du statut seul en interaction avec la variété et la parcelle sur le spectre de réflectance Globalement le statut HLB affecte le spectre de réflectance dans trois zones du spectre : dans le début du Red edge autour de 700 nm, dans le proche infrarouge autour de 800 nm et dans le Short-wave infrared autour de 2000 nm avec un pic à 2032 nm (valeur F = 751). Les effets du statut sont influencés dans le Red edge et le proche infrarouge par le type de variété sur laquelle les feuilles ont été prélevées. Cependant le pic de cette influence correspond à une zone où la valeur de Fisher est quasi-nulle pour leffet du statut sur la détection de la maladie par la réflectance. Cette influence des variétés est donc comprise entre les valeurs de Fisher de 200 à 150 en excluant la zone de creux. Ces valeurs sont assez faibles si on les compare aux effets du statut qui avoisine les 700 et plus. Les trois variétés ont donc un impact plutôt faible sur la détection de la maladie via la mesure de la réflectance. Cet impact est encore plus minime (valeur F = 30) au niveau du pic dinfluence de la maladie à 2032 nm correspondant à la quantité deau dans la feuille. Cet impact est encore plus faible pour linfluence de la parcelle sur le statut HLB. Celle-ci na quune très faible influence sur le statut HLB au niveau des spectres dans visible et le Red edge (valeur F = 98) et une influence quasi-nulle dans les autres longueurs donde. 3.3 Lapproche par arbre de décision Une autre approche pour mettre en évidence leffet du statut sur la détection de la maladie par la réflectance est la représentation en arbres de décision (figure 3.8). Figure 3.8: Arbre de décision sur la réflectance des données globales par rapport au statut HLB Cette autre approche apporte des résultats cohérents avec le F de Fisher sur les longueurs donde où le statut HLB a le plus dinfluence. Le premier nud de décision à la longueur donde 2000 nm est très significatif (p value 1.32e-36) et se divise entre les zones du Red edge à 706 nm pour 774 feuilles et du proche infrarouge à 1075 nm pour les 666 feuilles restantes. Sur les 774 feuilles du deuxième nud (p value 9.71e-18), 572 sont des feuilles issues darbres négatifs aux HLB à plus de 75% environ en additionnant la part des effectifs négatifs des nuds 6 et 7. Par ailleurs, sur les 666 feuilles du nud 9 (p value 4.84e-9), 333 sont globalement issues darbres positifs au HLB à plus de 75% environ en additionnant la part des effectifs positifs des nuds 10 et 13. Cela montre quil est possible didentifier depuis le spectre de réflectance, les arbres sains et malades avec un taux derreur denviron 75%. Lintérêt de cette méthode en plus de donner les longueurs donde discriminantes pour la maladie, est la valeur de réflectance pour laquelle chaque longueur donde discriminante est clivante. Enfin, en prenant uniquement la longueur donde la plus clivante (2000 nm) selon larbre de décision, il est possible de se rendre compte de lhétérogénéité des distributions à lintérieur de celle-ci (figure 3.9). Figure 3.9: Distribution des réflectances pour la longueur donde 2000 nm Malgré léchantillonnage différent selon les parcelles, les valeurs de réflectance sont distribuées de façon quasi-normale bien que centrées différemment. Chez Mrs. Barret et Pothin, le centre est quasiment sur 0.09 alors que chez Gonthier et Hoarau celui-ci est environ à 0.07. Concernant les variétés, les Zanzibars semblent avoir les valeurs de réflectances les moins élevées. Malgré cette hétérogénéité dans la répartition des variables, qui est quasiment identique pour toutes les autres longueurs donde, cela na finalement pas un énorme impact sur la discrimination de la réflectance en fonction du statut. 3.4 Comparaison des performances des 3 méthodes de prédiction du statut HLB à partir des spectres réflectance Pour prédire le statut des arbres à partir des spectres de réflectance, les trois méthodes danalyses statistiques en apprentissage supervisé sont mises en uvre. Pour chacune de ces méthodes, les paramètres de performance sont mesurés (table 3.2) après 100 simulations en calculs parallèles présentés en annexes 2 et 3. Table 3.2: Paramètres de performance du statut HLB par Régression par les Moindres Carrés Partiels Paramètres de performance Moyenne Ecart type Accuracy PLS 92.6 1.7 Accuracy RF 76.4 2.3 Accuracy SVM 85.8 2.7 Precision PLS 97.2 3.1 Precision RF 88.3 3.1 Precision SVM 86.6 3.6 Sensitivity PLS 88.3 2.7 Sensitivity RF 60.7 4.8 Sensitivity SVM 86.3 3.3 Au vu de ces simulations, la méthode de régression par les moindres carrés partiels (PLS) est la plus robuste avec une qualité de prédiction avoisinant les 92.6% et avec lécart type le plus faibles denviron 1.7. Cette méthode est aussi très robuste pour minimiser les erreurs de type 1 (précision à 97.2%) et de type 2 (sensibilité à 88.3%) avec là aussi des écarts types plus faible que les deux autres méthodes. Vient ensuite la méthode de la machine à vecteurs de support (SVM) avec une qualité de prédiction denviron 85.8% et avec lécart type le plus élevé avoisinant les 2.7. La méthode des forêts aléatoires (RF) est la moins robuste avec une qualité de prédiction de 76.4% approximativement. 3.5 Prédiction du statut HLB par Régression par les Moindres Carrés Partiels (PLS) Concrètement, en utilisant la meilleure méthode, qui est celle des moindres carrés partiels, le statut des arbres peut donc être prédit précisément (figure 3.10). Figure 3.10: Prédiction du statut HLB par Régression par les Moindres Carrés Partiels Cette représentation graphique est une aide à la décision pour déterminer le statut de chaque arbre à partir des résultats de la PLS. La prédiction par PLS donne une valeur correspondant à la moyenne des statuts prédits (compris entre 0 et 1 en ordonnés) des dix feuilles dun arbre pour chaque arbre (en abscisse). Cela indique pour chaque arbre sil est plutôt positif ou négatif, mais ça ne permet pas de trancher sur le statut de larbre. Cette prédiction se base donc sur deux seuils choisis via les observations de prédiction effectuées. Ces seuils sont compris entre 0.4 pour les arbres positifs qui seraient au-dessus de cette valeur (en rouge), 0.35 pour les arbres négatifs qui seraient en dessous de cette valeur (en vert) et les arbres indéterminés (en gris) qui seraient compris entre ces deux valeurs. Une comparaison entre le statut réel des arbres est confirmé par qPCR (avec un croix pour les négatifs et un rond pour les positifs), permet ensuite de réaliser la matrice de confusion (table 3.3). Table 3.3: Matrice de confusion de la méthode de Régression par les Moindres Carrés Partiels Négatif confirmé Positif confirmé Négatif prédit 57 2 Positif prédit 10 62 Sur cette prédiction, 62 arbres ont été prédits correctement positifs et 57 correctement négatifs. 10 arbres sont des faux positifs (erreur de type 1) et 2 sont des faux négatifs (erreur de type 2). Table 3.4: Paramètres de performance du statut HLB par Régression par les Moindres Carrés Partiels Accuracy 90.8 Precision 96.6 Sensitivity 85.1 La prédiction par la méthode de régression par PLS a lavantage davoir une précision élevée (96.6%) ce qui minimise les erreurs de type 2, ce qui est très utile pour lidentification de la maladie sur une parcelle (table 3.4). 3.6 Amélioration du protocole de terrain pour le choix du nombre de feuilles par arbre La méthode de la SVM est la méthode dont lestimation des performances est la plus rapide à exécuter. Elle est donc utilisée pour tester sil est possible dalléger le protocole déchantillonnage (figure 3.11). Figure 3.11: Prédiction des paramètres de SVM en fonction du nombre de feuilles échantillonnés sur chaque arbre, obtenu après avoir fait la moyenne de 1000 SVM Après 1000 simulations, les paramètres de performance de la méthode SVM sont respectivement de 95% pour la précision (Precision), 96% pour la sensibilité (Sensitivity) et 97% pour la qualité globale de la prédiction (Accuracy) pour un échantillonnage de 10 feuilles. La précision et la sensibilité passent en dessous des 90% avec 5 feuilles prélevées. Avec 8 feuilles échantillonnées, la qualité de la prédiction ainsi que la sensibilité ne baissent pas en dessous de 95%. 3.7 Amélioration du protocole de terrain pour le choix du nombre de mesures de réflectance par feuille Figure 3.12: Prédiction des paramètres de SVM en fonction du nombre de répétition SPIR par feuille échantillonnés sur chaque arbre, obtenu après avoir fait la moyenne de 100 SVM Après 100 simulations, les paramètres de performance de la méthode SVM sont respectivement de 85% pour la sensibilité (Sensitivity), 82% pour la qualité globale de la prédiction (Accuracy) et 81% pour la précision (Precision) pour un passage de 6 répétitions SPIR (figure 3.12). Les écarts types étant assez marqués, au bout de 3 répétitions SPIR les paramètres de performance sont très peu changeants. "],["discussion.html", "4 Discussion", " 4 Discussion Lobjectif de cette étude était de caractériser les sources de variations résultant de linfluence des parcelles, des variétés et du statut HLB sur les spectres de réflectance. Au vu des résultats, de par une valeur F de Fisher élevée (plus de 500 en moyenne), le lieu déchantillonnage semble avoir une influence significative sur les valeurs de réflectance de 750 à 2500 nm (figure 3.2). Dans une moindre mesure, la variété a aussi une influence sur les valeurs de réflectance de 1400 à 2500 nm (figure 3.3). Aucun de ces deux facteurs ne semble affecter les longueurs donde dans le visible de 350 à 700 nm et les effets des variétés et du lieu déchantillonnage sur le statut sont assez négligeables sur cette zone et dans linfrarouge courte longueur donde (de 1400 à 2500 nm). Le statut seul a donc une influence sur cette partie du spectre avec une influence modérée des variétés et du lieu déchantillonnage (figure 3.7). Ainsi, dans le visible et le début du Red edge, cette influence peut sexpliquer par une moins bonne absorbance de la lumière par la chlorophylle des feuilles à cause de la maladie. Dans le proche infrarouge autour de 800 nm le statut a aussi une influence importante sur la réflectance avec en parallèle une influence importante du lieu déchantillonnage sur cette partie du spectre (figure 3.3). Le proche infrarouge correspondant à la structure interne de la feuille a un effet sur le spectre de réflectance global dû à la maladie. En effet, le HLB affecte la structure cellulaire et en particulier celle du phloème, là où la bactérie se développe. Celle-ci va entraîner des nécroses et obstruer les vaisseaux. Ces dégradations vont donc altérer la réflectance de la lumière de cette partie de la feuille ce qui se voit lors de lanalyse des spectres. Pour finir, cest dans linfrarouge courte longueur donde autour de 2000 nm que sobserve la plus grande valeur F de Fisher (figure 3.7) mais cest aussi une zone du spectre où le lieu déchantillonnage (figure 3.3) et les variétés (figure 3.2) dans une moindre mesure ont un effet sur la réflectance globale. Leffet du statut sur cette zone peut sexpliquer par une moins bonne absorbance de la lumière par la chlorophylle des feuilles en lien avec la maladie (figure 3.5). Leffet du statut sur cette zone peut sexpliquer par le fait que le HLB affecte grandement lalimentation en eau de la feuille par lobstruction des vaisseaux (Bové, 2006). En plus de lapproche par la variance via lANOVA, lapproche par arbre de décision a permis de mettre en évidence dune autre manière les longueurs donde discriminantes les plus clivantes. Ainsi, au vu de ces deux approches pour détecter plus facilement la maladie, trois tranches de longueurs donde sont à favoriser, autour de 700 nm, 1000 nm et 2000 nm (figure 3.8). Ces longueurs donde trouvées sont similaires à celles présentes dans la littérature pour la détection du HLB (Mishra et al., 2007). La réalisation dun modèle de prédiction du statut HLB par arbre à partir du spectre de réflectance sest révélée être pertinente à bien des égards. Le modèle de prédiction a permis de connaître létat sanitaire des arbres via trois méthodes danalyse des spectres de réflectance. Ces trois méthodes ont des qualités de prédiction qui varient de 92.6% pour la méthode PLS à 85.8% et 76.4% pour la méthode SVM et RF (table 3.2). Ces valeurs sont là aussi proches de celles présentes dans la bibliographie concernant la qualité de la prédiction avec 85% pour le SVM dans larticle de Sindhuja Sankaran (Sankaran et al., 2013) et 96.4% pour la PLS dans larticle de Xiaoling Deng (Deng et al., 2020). La méthode PLS étant la meilleure, elle permet de minimiser les erreurs de type 2 pour une meilleure identification de la maladie sur les parcelles (table 3.2). Cela peut sexpliquer dans la mesure où lun des principaux intérêts de lalgorithme PLS est daugmenter en performance et en fiabilité proportionnellement avec laugmentation du nombre de variables explicatives permettant de prédire les composantes du modèle. Cest donc la méthode PLS qui est à favoriser pour les prédictions du statut HLB. Finalement, cette étude confirme le haut potentiel quoffre lutilisation de la Spectroscopie Proche Infrarouge via une classification par PLS et SVM avec une approche orientée à la feuille pour la caractérisation de linfection au HLB. Cette caractérisation est possible grâce aux seuils de décision trouvés. Ces deux seuils sont de 0.4 et plus pour les arbres malades à 0.35 et moins pour les arbres sains avec une classe indéterminée entre ces deux seuils. Ces analyses ont aussi permis daméliorer le protocole de terrain en préconisant un échantillonnage minimal de huit feuilles par arbres (figure 3.11) et trois répétitions SPIR par feuille (figure 3.12) pour un bon compromis entre le temps déchantillonnage et la précision du modèle. Lutilisation de la proxidétection dans la surveillance du HLB doit tout de même être couplée à un travail de terrain avec analyse en qPCR pour la validation du statut des arbres. Le modèle de prédiction réalisée dans ce rapport pourra, à terme, être utilisé comme un outil de détection décisif dans lamélioration de surveillance épidémiologique du HLB à La Réunion, surtout si le modèle est alimenté avec de nouveaux échantillons dans le but dagrandir la base dapprentissage. En effet, ce modèle est pour linstant valable uniquement pour trois variétés dagrumes sur les 27 que compte la Réunion. Afin doptimiser ce modèle, il serait intéressant de lenrichir avec davantage de variétés sur des lieux déchantillonnages différents. Cela permettrait de répéter les analyses effectuées en comparant les résultats et les performances des différentes méthodes dapprentissage supervisé testées pour améliorer le modèle. "],["conclusion.html", "5 Conclusion", " 5 Conclusion Face à la résurgence actuelle du HLB à la Réunion, le potentiel dun diagnostic HLB par SPIR, plus rapide que les analyses en laboratoire et peu onéreux est prometteur. La construction de ce modèle de détection permettra de prédire le statut HLB des arbres sur différentes parcelles et den évaluer lefficacité. Ce modèle permettra daccentuer leffort de surveillance sur les foyers de production les plus à risque où un échantillonnage qPCR classique nest pas envisageable à grande échelle au regard des ressources disponibles. Le modèle pouvant déterminer assez précisément quels arbres sont infectés au HLB au sein dune parcelle, cela permettra daccompagner au mieux les agriculteurs dans la lutte contre la maladie. Ainsi, prédire le statut HLB des parcelles dagrumes par apprentissage supervisé est une solution prometteuse bien que la base de données dapprentissage doit être étoffée pour garantir une prédiction plus juste à long terme. "],["annexe.html", "6 Annexe 6.1 Annexe 1 : Importation des données brutes 6.2 Annexe 2 : Fonction Matrice de confusion 6.3 Annexe 3 : Matrice de confusion des 3 méthodes de machin learning 6.4 Annexe 4 : Fonction nombre de feuille 6.5 Annexe 5 : Prédiction du nombre optimal de feuille 6.6 Annexe 6 : Fonction nombre de répétition SPIR par feuille 6.7 Annexe 7 : Prédiction du nombre de répétition optimal", " 6 Annexe 6.1 Annexe 1 : Importation des données brutes &gt; library(tidyr) # pivot longer &amp; pivot_wider &gt; # Importation des donnees SPIR Global #### &gt; data_SPIR_Ed &lt;- read.table(file = &quot;SPIR_Global.csv&quot;, + header = T, sep = &quot;;&quot;, stringsAsFactors = T, row.names = 1, + na.strings = c(&quot;&quot;, &quot;NA&quot;), dec = &quot;,&quot;) &gt; # Creation des colonne &#39;code&#39; de data_SPIR_Ed &gt; code_labo &lt;- rownames(data_SPIR_Ed) &gt; names(data_SPIR_Ed)[1] = c(&quot;code_variete&quot;) &gt; names(data_SPIR_Ed)[2] = c(&quot;code_agri&quot;) &gt; data_SPIR_Ed$code_nbr_rep &lt;- factor(substr(code_labo, + 8, 8)) &gt; data_SPIR_Ed$code_ech_arbre &lt;- factor(substr(code_labo, + 1, 2)) &gt; data_SPIR_Ed$code_ech_feuille &lt;- factor(substr(code_labo, + 1, 3)) &gt; data_SPIR_Ed$code_rep_feuille &lt;- factor(paste(data_SPIR_Ed$code_ech_feuille, + data_SPIR_Ed$code_nbr_rep, sep = &quot;&quot;)) &gt; rm(code_labo) &gt; data_SPIR_Ed &lt;- data_SPIR_Ed[!is.na(data_SPIR_Ed$X350), + ] &gt; # Importation et preparation des resultats de la &gt; # Qpcr Globaux #### &gt; data_Qpcr_Ed &lt;- read.table(file = &quot;qPCR_global_Ed.csv&quot;, + header = T, sep = &quot;;&quot;, stringsAsFactors = T, row.names = 1, + na.strings = c(&quot;&quot;, &quot;NA&quot;), dec = &quot;,&quot;) &gt; # on stocke les noms d&#39;echantillons positifs selon &gt; # nos 2 seuils de Ct (cycle de qPCR ), a savoir &gt; # moins de 32 cyclces et moins de 36 cycles qPCR &gt; seuils &lt;- c(32, 36) &gt; trueP &lt;- lapply(seuils, function(x) unique(data_Qpcr_Ed$Sample.Name[which(data_Qpcr_Ed$C..Mean &lt; + x &amp; data_Qpcr_Ed$C..SD &lt; 1)])) &gt; names(trueP) &lt;- paste(&quot;seuil&quot;, seuils, sep = &quot;.&quot;) &gt; data_SPIR_Ed[paste(&quot;qPCR&quot;, seuils, sep = &quot;_&quot;)] &lt;- lapply(trueP, + function(x) as.numeric(data_SPIR_Ed$code_ech_arbre %in% + x)) &gt; # on cherche quels sont les code_ech_arbre qui se &gt; # trouvent dans le vecteur x x reprenant &gt; # automatiquement les noms des arbres positifs &gt; # selon le seuil choisi &gt; select.lambda &lt;- grep(&quot;^X&quot;, names(data_SPIR_Ed)) &gt; data_SPIR_Ed &lt;- data_SPIR_Ed[, c(names(data_SPIR_Ed)[-select.lambda], + names(data_SPIR_Ed)[select.lambda])] &gt; rm(data_Qpcr_Ed, select.lambda, seuils) &gt; data_SPIR_Ed[c(&quot;qPCR_32&quot;, &quot;qPCR_36&quot;)] &lt;- lapply(data_SPIR_Ed[c(&quot;qPCR_32&quot;, + &quot;qPCR_36&quot;)], factor) &gt; # Format_long #### &gt; select.lambda &lt;- grep(&quot;^X&quot;, names(data_SPIR_Ed)) &gt; data_long_Ed &lt;- pivot_longer(data = data_SPIR_Ed, cols = select.lambda, + values_to = &quot;reflectance&quot;, names_to = &quot;lambda&quot;) &gt; data_long_Ed$lambda &lt;- as.numeric(gsub(&quot;X&quot;, &quot;&quot;, data_long_Ed$lambda)) &gt; data_long_Ed &lt;- data_long_Ed[!is.na(data_long_Ed$reflectance), + ] 6.2 Annexe 2 : Fonction Matrice de confusion &gt; fct_ConfusionMatrix &lt;- function(nb.rep, seuil.ct, list.feuilles) { + maliste &lt;- lapply(list.feuilles, function(feuille) { + list_svm &lt;- feuille[sample(1:length(feuille$code_ech_feuille), + nb.rep), ] + # on fait ça pour tte les feuilles mais tjrs en + # choisissant le nombre de rep tire aleatoirement + code &lt;- grep(&quot;^code_ech&quot;, names(list_svm)) + qPCR &lt;- grep(&quot;^qPCR_&quot;, names(list_svm)) + sortie &lt;- cbind.data.frame(unique(list_svm[c(code, + qPCR)]), matrix(apply(list_svm[-(which(colnames(list_svm) == + &quot;code_variete&quot;):which(colnames(list_svm) == + &quot;qPCR_36&quot;))], 2, mean), nr = 1, dimnames = list(NULL, + names(list_svm)[-(which(colnames(list_svm) == + &quot;code_variete&quot;):which(colnames(list_svm) == + &quot;qPCR_36&quot;))]))) + sortie + }) + test_ed &lt;- do.call(rbind, maliste) # on colle toute les listes créées précédement + test_ed &lt;- test_ed[-(which(colnames(test_ed) == + &quot;qPCR_32&quot;))] + test_ed[[paste0(&quot;qPCR_&quot;, seuil.ct)]] &lt;- as.numeric(as.character(test_ed[[paste0(&quot;qPCR_&quot;, + seuil.ct)]])) + decoup &lt;- sample.split(test_ed[, paste0(&quot;qPCR_&quot;, + seuil.ct)], SplitRatio = 0.5) # on decoupe le jeu de donné en training set et test set + training_set &lt;- test_ed[decoup, ] + test_set &lt;- test_ed[!decoup, ] + # Criteres choisi pour la separation des donnees + crit.pos &lt;- 0.4 + crit.neg &lt;- 0.35 + trueP$seuil.32 &lt;- NULL + # Prediction RF #### + model_rf_36 &lt;- randomForest(x = training_set[, + grep(&quot;^X&quot;, names(training_set))], y = training_set[[paste0(&quot;qPCR_&quot;, + seuil.ct)]], ntree = 100) + # Prediction sur les feuilles de la base + # d&#39;apprentissage + rf_pred &lt;- test_set + rf_pred$rf_pred_36 &lt;- predict(model_rf_36, newdata = test_set, + decision.values = T) + # Conversion des resultats de la prediction en + # numerique + rf_pred$rf_pred_36 = as.numeric(as.character(rf_pred$rf_pred_36)) + # Moyennage des resultats de la prediction pour + # chaque arbres + rf_pred_arbres_36 = aggregate(rf_pred_36 ~ code_ech_arbre, + data = rf_pred, mean, na.rm = T) + rf_pred_arbres_36$crit &lt;- 0.5 + rf_pred_arbres_36$crit[rf_pred_arbres_36$rf_pred_36 &gt;= + crit.pos] &lt;- 1 + rf_pred_arbres_36$crit[rf_pred_arbres_36$rf_pred_36 &lt;= + crit.neg] &lt;- 0 + # Creation d&#39;une nouvelle colonne des resulats issu + # de la qPCR, pour comparer à la valeurs predite + rf_pred_arbres_36[paste(&quot;qPCR&quot;, seuil.ct, sep = &quot;_&quot;)] &lt;- lapply(trueP, + function(x) as.numeric(rf_pred_arbres_36$code_ech_arbre %in% + x)) + # Résultats de la prédiction sous forme de matrice + # de confusion + rf_pred_arbres_36$crit &lt;- factor(rf_pred_arbres_36$crit, + levels = c(0, 1)) + rf_confusion_matrix_36 &lt;- ftable(qPCR_36 ~ crit, + data = rf_pred_arbres_36) + rf_confusion_matrix_36 &lt;- as.matrix(rf_confusion_matrix_36) + TP_rf &lt;- rf_confusion_matrix_36[1, 1] + TN_rf &lt;- rf_confusion_matrix_36[2, 2] + FN_rf &lt;- rf_confusion_matrix_36[2, 1] + FP_rf &lt;- rf_confusion_matrix_36[1, 2] + # Calcul des parametres rf de la matrice de + # confusion + Accuracy_rf36 &lt;- ((TP_rf + TN_rf)/(TP_rf + TN_rf + + FN_rf + FP_rf) * 100) + Precision_rf36 &lt;- ((TP_rf/(TP_rf + FP_rf) * 100)) + Sensitivity_rf36 &lt;- ((TP_rf/(TP_rf + FN_rf) * 100)) + Parametre_rf_36 &lt;- rbind(Accuracy_rf36, Precision_rf36, + Sensitivity_rf36) + # Prediction SVM #### + model_SVM_36 &lt;- svm(y = training_set[, paste0(&quot;qPCR_&quot;, + seuil.ct)], x = training_set[, grep(&quot;^X&quot;, names(training_set))], + type = &quot;C-classification&quot;, kernel = &quot;linear&quot;) + # Prediction sur le test_set + svm_pred &lt;- test_set + svm_pred$svm_pred_36 &lt;- predict(model_SVM_36, newdata = test_set[, + grep(&quot;^X&quot;, names(test_set))], decision.values = T) + # Conversion des resultats de la prediction en + # numerique + svm_pred$svm_pred_36 = as.numeric(as.character(svm_pred$svm_pred_36)) + # Moyennage des resultats de la prediction pour + # chaque arbres + svm_pred_arbres_36 = aggregate(svm_pred_36 ~ code_ech_arbre, + data = svm_pred, mean, na.rm = T) + # Critere choisi sur les observations graphiques + svm_pred_arbres_36$crit &lt;- 0.5 + svm_pred_arbres_36$crit[svm_pred_arbres_36$svm_pred_36 &gt;= + crit.pos] &lt;- 1 + svm_pred_arbres_36$crit[svm_pred_arbres_36$svm_pred_36 &lt;= + crit.neg] &lt;- 0 + # Creation d&#39;une nouvelle colonne des resulats issu + # de la qPCR, pour comparer à la valeurs predite + svm_pred_arbres_36[paste(&quot;qPCR&quot;, seuil.ct, sep = &quot;_&quot;)] &lt;- lapply(trueP, + function(x) as.numeric(svm_pred_arbres_36$code_ech_arbre %in% + x)) + # Résultats de la prédiction sous forme de matrice + # de confusion + svm_pred_arbres_36$crit &lt;- factor(svm_pred_arbres_36$crit, + levels = c(0, 1)) + svm_confusion_matrix_36 &lt;- ftable(qPCR_36 ~ crit, + data = svm_pred_arbres_36) + svm_confusion_matrix_36 &lt;- as.matrix(svm_confusion_matrix_36) + TP_svm &lt;- svm_confusion_matrix_36[1, 1] + TN_svm &lt;- svm_confusion_matrix_36[2, 2] + FN_svm &lt;- svm_confusion_matrix_36[2, 1] + FP_svm &lt;- svm_confusion_matrix_36[1, 2] + # Calcul des parametres svm de la matrice de + # confusion + Accuracy_svm36 &lt;- ((TP_svm + TN_svm)/(TP_svm + + TN_svm + FN_svm + FP_svm) * 100) + Precision_svm36 &lt;- ((TP_svm/(TP_svm + FP_svm) * + 100)) + Sensitivity_svm36 &lt;- ((TP_svm/(TP_svm + FN_svm) * + 100)) + Parametre_svm_36 &lt;- rbind(Accuracy_svm36, Precision_svm36, + Sensitivity_svm36) + # Prediction PLS #### + model_pls_36 &lt;- plsr(training_set[[paste0(&quot;qPCR_&quot;, + seuil.ct)]] ~ ., data = training_set[, grep(&quot;^X&quot;, + names(training_set))], scale = TRUE, validation = &quot;CV&quot;) + # Prediction + pls_pred &lt;- test_set + # Prediction sur les feuilles de la base + # d&#39;apprentissage + pls_pred$pls_pred_36 &lt;- predict(model_pls_36, newdata = test_set[, + grep(&quot;^X&quot;, names(test_set))], decision.values = T, + ncomp = 100) + # Conversion des resultats de la prediction en + # numerique + pls_pred$pls_pred_36 = as.numeric(as.character(pls_pred$pls_pred_36)) + # Moyennage des resultats de la prediction pour + # chaque arbres + pls_pred_arbres_36 = aggregate(pls_pred_36 ~ code_ech_arbre, + data = pls_pred, mean, na.rm = T) + # Parametrage pour presentation graphique et la + # matrice de confusion + pls_pred_arbres_36$crit &lt;- 0.5 + pls_pred_arbres_36$crit[pls_pred_arbres_36$pls_pred_36 &gt;= + crit.pos] &lt;- 1 + pls_pred_arbres_36$crit[pls_pred_arbres_36$pls_pred_36 &lt;= + crit.neg] &lt;- 0 + # Creation d&#39;une nouvelle colonne des resulats issu + # de la qPCR, pour comparer à la valeurs predite + pls_pred_arbres_36[paste(&quot;qPCR&quot;, seuil.ct, sep = &quot;_&quot;)] &lt;- lapply(trueP, + function(x) as.numeric(pls_pred_arbres_36$code_ech_arbre %in% + x)) + # Résultats de la prédiction sous forme de matrice + # de confusion + pls_pred_arbres_36$crit &lt;- factor(pls_pred_arbres_36$crit, + levels = c(0, 1)) + pls_confusion_matrix_36 &lt;- ftable(qPCR_36 ~ crit, + data = pls_pred_arbres_36) + pls_confusion_matrix_36 &lt;- as.matrix(pls_confusion_matrix_36) + TP_pls &lt;- pls_confusion_matrix_36[1, 1] + TN_pls &lt;- pls_confusion_matrix_36[2, 2] + FN_pls &lt;- pls_confusion_matrix_36[2, 1] + FP_pls &lt;- pls_confusion_matrix_36[1, 2] + # Calcul des parametres pls de la matrice de + # confusion + Accuracy_pls36 &lt;- ((TP_pls + TN_pls)/(TP_pls + + TN_pls + FN_pls + FP_pls) * 100) + Precision_pls36 &lt;- ((TP_pls/(TP_pls + FP_pls) * + 100)) + Sensitivity_pls36 &lt;- ((TP_pls/(TP_pls + FN_pls) * + 100)) + Parametre_pls_36 &lt;- rbind(Accuracy_pls36, Precision_pls36, + Sensitivity_pls36) + parametre_36 &lt;- rbind(Parametre_rf_36, Parametre_svm_36, + Parametre_pls_36) + All_parametre_36 &lt;- as.vector(parametre_36) + names(All_parametre_36) &lt;- c(rownames(parametre_36)) + All_parametre_36 + } 6.3 Annexe 3 : Matrice de confusion des 3 méthodes de machin learning &gt; # Library #### &gt; library(pls) # package pls &gt; library(randomForest) # package RF &gt; library(e1071) # package SVM &gt; library(tidyr) # pivot longer &amp; pivot wider &gt; library(snowfall) # Utilisation du calcul paralell pour optimiser la vitesse de calcul &gt; # Importation des fonctions utiles &gt; source(file = &quot;Fct_ConfusionMatrix_ct36.R&quot;) # Annex 2 &gt; nb.simu &lt;- 100 # Minimu 1000 simu &gt; rep.max &lt;- 6 # nombre de repetition SPIR sur les feuilles , maximum 6 &gt; Tirage &lt;- split(data_SPIR_Ed, data_SPIR_Ed$code_ech_feuille, + drop = T) # drop = T pour enlever les tiroirs vides !! &gt; # Calcul parralelle &gt; sfInit(parallel = T, cpus = 4) # optimisation des processeurs sur les 4 coeurs &gt; sfLibrary(caTools) # la library des packages utilisés &gt; sfLibrary(pls) &gt; sfLibrary(randomForest) &gt; sfLibrary(e1071) &gt; sfLibrary(caret) &gt; sfExport(&quot;fct_ConfusionMatrix&quot;, &quot;Tirage&quot;, &quot;rep.max&quot;, + &quot;nb.simu&quot;, &quot;trueP&quot;) # les éléments extérieur à la fonction &gt; T1 &lt;- Sys.time() # information sur le temps que met l&#39;operation a se realiser &gt; # res.svm.36 &lt;- sfClusterApplySR(rep(1:rep.max, &gt; # each = nb.simu), fct_svm , seuil.ct = 36 , &gt; # list.feuilles= Tirage , restore = F, perUpdate = &gt; # 6 ) # restore = T seulement si ça plante ! &gt; res.ML.36 &lt;- sfClusterApplyLB(rep(rep.max, each = nb.simu), + fct_ConfusionMatrix, seuil.ct = 36, list.feuilles = Tirage) &gt; # fct_svm on remplsis les 3 arguments qui sont : &gt; # nb.rep, seuil.ct, list.feuilles &gt; T2 &lt;- Sys.time() &gt; sfStop() # stop l&#39;utilisation du sfInit aux autres lignes de codes &gt; difftime(T2, T1) # information sur le temps qu&#39;à mis l&#39;operation &gt; intermed.36 &lt;- as.data.frame(do.call(rbind, res.ML.36)) &gt; # permet de basculer de la liste à la data.frame &gt; # pour le resultat issu de sfClusterApplyLB &gt; ML_global.36 &lt;- pivot_longer((intermed.36), cols = 1:9, + names_to = &quot;critere&quot;, values_to = &quot;valeurs&quot;) &gt; # On moyenne tout les parametres pour chaque type &gt; # de machin learning &gt; ML.36 &lt;- aggregate(valeurs ~ critere, ML_global.36, + mean) &gt; names(ML.36)[2] &lt;- &quot;Moyenne&quot; &gt; # Meme chose avec l&#39;ecart type &gt; ML.36$et &lt;- aggregate(valeurs ~ critere, ML_global.36, + sd)$valeurs &gt; ML.36 6.4 Annexe 4 : Fonction nombre de feuille &gt; fct_feuille &lt;- function(nb.feuille, seuil.ct, list.arbres) { + maliste &lt;- lapply(list.arbres, function(arbre) { + if (nb.feuille &lt; nrow(arbre)) + list_svm &lt;- arbre[sample(1:length(arbre$code_ech_arbre), + nb.feuille), ] else list_svm &lt;- arbre + # on fait ça pour tte les feuilles mais tjrs en + # choisissant le nombre de rep tire aleatoirement + code &lt;- grep(&quot;^code_ech&quot;, names(list_svm)) + qPCR &lt;- grep(&quot;^qPCR_&quot;, names(list_svm)) + sortie &lt;- cbind.data.frame(unique(list_svm[c(code, + qPCR)]), matrix(apply(list_svm[-(which(colnames(list_svm) == + &quot;code_ech_feuille&quot;):which(colnames(list_svm) == + &quot;qPCR_36&quot;))], 2, mean), nr = 1, dimnames = list(NULL, + names(list_svm)[-(which(colnames(list_svm) == + &quot;code_ech_feuille&quot;):which(colnames(list_svm) == + &quot;qPCR_36&quot;))]))) + sortie + }) + test_ed &lt;- do.call(rbind, maliste) # on colle toute les listes créées précédement + decoup &lt;- sample.split(test_ed[, paste0(&quot;qPCR_&quot;, + seuil.ct)], SplitRatio = 0.75) # on decoupe le jeu de donné en training set et test set + training_set &lt;- test_ed[decoup, ] + test_set &lt;- test_ed[!decoup, ] + res.svm &lt;- svm(y = training_set[, paste0(&quot;qPCR_&quot;, + seuil.ct)] # ici on prend les seuil donc sois 32 sois 36 , avec &#39;paste0&#39; colle sans separateurs + , + x = training_set[, grep(&quot;^X&quot;, names(training_set))] # ici on prend ttes les longueurs d&#39;ondes + , + type = &quot;C-classification&quot;, kernel = &quot;linear&quot;) + svm_pred &lt;- predict(res.svm, newdata = test_set[, + grep(&quot;^X&quot;, names(test_set))]) + svm.confusion &lt;- confusionMatrix(data = svm_pred, + reference = test_set[, paste0(&quot;qPCR_&quot;, seuil.ct)]) + sortie &lt;- c(svm.confusion$overall[1], svm.confusion$byClass[1], + svm.confusion$byClass[3]) # combine les 3 parametres recherches + names(sortie) &lt;- c(&quot;Accuracy&quot;, &quot;Sensitivity&quot;, &quot;Precision&quot;) # renomer + sortie + } 6.5 Annexe 5 : Prédiction du nombre optimal de feuille &gt; rm(list = ls()) # nettoyage des listes de l&#39;environnement de travail &gt; # Library #### &gt; library(pls) # PLS &gt; library(ggplot2) # Package ggplot pour graphiques &gt; library(ggdark) # Met un style de graphique ggplot en noir &gt; library(ggpubr) # Utilisation de la fonction ggarrange qui permet de coller 2 graphiques &gt; library(caTools) # sample.split &gt; library(tidyr) # pivot longer &amp; pivot wider &gt; library(snowfall) # Utilisation du calcul paralell pour optimiser la vitesse de calcul &gt; # Importation des fonctions utiles &gt; source(file = &quot;Scripts/Prediction/Fct_Feuilles.R&quot;) # fonction feuille avec SVM &gt; # Importation du jeu de donnee Global &gt; load(&quot;Sauvegardes_objet_R.data/Jeux de donnee/data_SPIR_Ed.Rdata&quot;) &gt; # I) Parametres SVM Ct&lt;36 #### &gt; nb.simu &lt;- 1 # Minimu 1000 simu Time difference of 15.39098 hours pour 1000 simu &gt; nb.feuille &lt;- 10 # nombre de feuilles echantillonees par arbre , maximum 10 &gt; seuil.ct &lt;- 36 &gt; intermed.arbre &lt;- aggregate(reflectance ~ code_ech_feuille + + code_ech_arbre + qPCR_32 + qPCR_36 + lambda, data = data_long_Ed, + mean) &gt; mean.arbre &lt;- pivot_wider(intermed.arbre, names_from = &quot;lambda&quot;, + values_from = &quot;reflectance&quot;, names_prefix = &quot;X&quot;) &gt; Tirage &lt;- split(mean.arbre, mean.arbre$code_ech_arbre, + drop = T) # drop = T pour enlever les tiroirs vide &gt; ## I.a) Calcul parallele #### &gt; sfInit(parallel = T, cpus = 4) # optimisation des processeurs sur les 4 coeurs &gt; sfLibrary(caTools) # la library des packages utilisés &gt; sfLibrary(e1071) &gt; sfLibrary(pls) &gt; sfLibrary(caret) &gt; sfExport(&quot;fct_feuille&quot;, &quot;Tirage&quot;, &quot;nb.feuille&quot;, &quot;nb.simu&quot;) # les elements exterieur a la fonction &gt; T1 &lt;- Sys.time() # information sur le temps que met l&#39;operation a se realiser &gt; # res.svm.36 &lt;- sfClusterApplySR(rep(1:rep.max, &gt; # each = nb.simu), fct_svm , seuil.ct = 36 , &gt; # list.feuilles= Tirage , restore = F, perUpdate = &gt; # 6 ) # restore = T seulement si ça plante ! &gt; res.svm.36 &lt;- sfClusterApplyLB(rep(1:nb.feuille, each = nb.simu), + fct_feuille, seuil.ct = 36, list.arbres = Tirage) &gt; # fct_svm on remplsis les 3 arguments qui sont : &gt; # nb.rep, seuil.ct, list.feuilles &gt; T2 &lt;- Sys.time() &gt; sfStop() # stop l&#39;utilisation du sfInit aux autres lignes de codes &gt; difftime(T2, T1) # information sur le temps qu&#39;a mis l&#39;operation &gt; ## I.b) Enregistrement des criteres de precision &gt; ## #### &gt; # load(&#39;Sauvegardes_objet_R.data/SVM_ct36_6rep_100simu_3cpu_sfClusterApplyLB.Rdata&#39;) &gt; intermed.36 &lt;- as.data.frame(do.call(rbind, res.svm.36)) &gt; # permet de basculer de la liste à la data.frame &gt; # pour le resultat issu de sfClusterApplyLB &gt; data_global.36 &lt;- pivot_longer((intermed.36), cols = 1:3, + names_to = &quot;critere&quot;, values_to = &quot;valeurs&quot;) &gt; data_global.36$nb.rep &lt;- rep(1:nb.feuille, each = (nb.simu * + 3)) 6.6 Annexe 6 : Fonction nombre de répétition SPIR par feuille &gt; fct_svm &lt;- function(nb.rep, seuil.ct, list.feuilles) { + maliste &lt;- lapply(list.feuilles, function(feuille) { + # On cree une list qui piochera au hazard 1 feuille + # avec le nombre de rep correspondant + if (nb.rep &lt; nrow(feuille)) + list_svm &lt;- feuille[sample(1:length(feuille$code_ech_feuille), + nb.rep), ] else list_svm &lt;- feuille + # on fait ça pour tte les feuilles mais tjrs en + # choisissant le nombre de rep tire aleatoirement + code &lt;- grep(&quot;^code_ech&quot;, names(list_svm)) + qPCR &lt;- grep(&quot;^qPCR_&quot;, names(list_svm)) + sortie &lt;- cbind.data.frame(unique(list_svm[c(code, + qPCR)]), matrix(apply(list_svm[-(which(colnames(list_svm) == + &quot;code_nbr_rep&quot;):which(colnames(list_svm) == + &quot;qPCR_36&quot;))], 2, mean) # on moyenne la valeur des rep pour chaque feuille + , + nr = 1, dimnames = list(NULL, names(list_svm)[-(which(colnames(list_svm) == + &quot;code_nbr_rep&quot;):which(colnames(list_svm) == + &quot;qPCR_36&quot;))]))) + sortie + }) + test_ed &lt;- do.call(rbind, maliste) # on colle toute les listes créées précédement + decoup &lt;- sample.split(test_ed[, paste0(&quot;qPCR_&quot;, + seuil.ct)], SplitRatio = 0.75) # on decoupe le jeu de donné en training set et test set + training_set &lt;- test_ed[decoup, ] + test_set &lt;- test_ed[!decoup, ] + res.svm &lt;- svm(y = training_set[, paste0(&quot;qPCR_&quot;, + seuil.ct)] # ici on prend les seuil donc sois 32 sois 36 , avec &#39;paste0&#39; colle sans separateurs + , + x = training_set[, grep(&quot;^X&quot;, names(training_set))] # ici on prend ttes les longueurs d&#39;ondes + , + type = &quot;C-classification&quot;, kernel = &quot;linear&quot;) + svm_pred &lt;- predict(res.svm, newdata = test_set[, + grep(&quot;^X&quot;, names(test_set))]) + svm.confusion &lt;- confusionMatrix(data = svm_pred, + reference = test_set[, paste0(&quot;qPCR_&quot;, seuil.ct)]) + sortie &lt;- c(svm.confusion$overall[1], svm.confusion$byClass[1], + svm.confusion$byClass[3]) # combine les 3 parametres recherches + names(sortie) &lt;- c(&quot;Accuracy&quot;, &quot;Sensitivity&quot;, &quot;Precision&quot;) + sortie + } 6.7 Annexe 7 : Prédiction du nombre de répétition optimal &gt; # Library #### &gt; library(e1071) # SVM &gt; library(pls) # PLS &gt; library(ggplot2) # Package ggplot pour graphiques &gt; library(ggdark) # Met un style de graphique ggplot en noir &gt; library(ggpubr) # Utilisation de la fonction ggarrange qui permet de coller 2 graphiques &gt; library(caTools) # sample.split &gt; library(tidyr) # pivot longer &amp; pivot wider &gt; library(caret) # fonction confusionMatrix &gt; library(snowfall) # Utilisation du calcul paralell pour optimiser la vitesse de calcul &gt; # Importation des fonctions utiles &gt; source(file = &quot;Scripts/Prediction/Fct_SVM.R&quot;) # pour calculer avec fonction svm &gt; # source(file = &#39;Scripts/Prediction/Fct_PLS.R&#39;) # &gt; # pour calculer avec fonction pls &gt; # Importation du jeu de donnee Global &gt; load(&quot;Sauvegardes_objet_R.data/Jeux de donnee/data_SPIR_Ed.Rdata&quot;) &gt; # I) Parametres SVM Ct&lt;36 #### &gt; nb.simu &lt;- 100 # nombre de simulation &gt; rep.max &lt;- 6 # nombre de repetition SPIR sur les feuilles , maximum 6 &gt; Tirage &lt;- split(data_SPIR_Ed[, -c(1:2)], data_SPIR_Ed$code_ech_feuille, + drop = T) # drop = T pour enlever les tiroirs vides ! &gt; ## I.a) Calcul parallele #### &gt; sfInit(parallel = T, cpus = 4) # optimisation des processeurs sur les 4 coeurs &gt; sfLibrary(caTools) # la library des packages utilisés &gt; sfLibrary(e1071) # pour fct_svm &gt; sfLibrary(pls) # pour fct_pls &gt; sfLibrary(caret) &gt; sfExport(&quot;fct_svm&quot;, &quot;Tirage&quot;, &quot;rep.max&quot;, &quot;nb.simu&quot;) # les elements exterieur a la fonction &gt; T1 &lt;- Sys.time() # information sur le temps que met l&#39;operation a se realiser &gt; res.svm.36 &lt;- sfClusterApplyLB(rep(1:rep.max, each = nb.simu), + fct_svm, seuil.ct = 36, list.feuilles = Tirage) &gt; # fct_svm on remplsis les 3 arguments qui sont : &gt; # nb.rep, seuil.ct, list.feuilles &gt; T2 &lt;- Sys.time() &gt; sfStop() # stop l&#39;utilisation du sfInit aux autres lignes de codes &gt; difftime(T2, T1) # information sur le temps qu&#39;a mis l&#39;operation &gt; ## I.b) Enregistrement des criteres de precision &gt; ## #### &gt; # load(&#39;Sauvegardes_objet_R.data/SVM_ct36_6rep_100simu_3cpu_sfClusterApplyLB.Rdata&#39;) &gt; intermed.36 &lt;- as.data.frame(do.call(rbind, res.svm.36)) &gt; # permet de basculer de la liste à la data.frame &gt; # pour le resultat issu de sfClusterApplyLB &gt; data_global.36 &lt;- pivot_longer((intermed.36), cols = 1:3, + names_to = &quot;critere&quot;, values_to = &quot;valeurs&quot;) &gt; data_global.36$nb.rep &lt;- rep(1:rep.max, each = (rep.max * + nb.simu/2)) "],["bibliographie.html", "Bibliographie", " Bibliographie Albetis de la Cruz J.L. 2018. Potentiel des images multispectrales acquises par drone dans la détection des zones infectées par la Flavescence dorée de la vigne. (THÈSE DE DOCTORAT EN SCIENCES AGRONOMIQUES Spécialité : Sciences de la Production Végétale). Toulouse : Université Toulouse 3 Paul Sabatier (UT3 Paul Sabatier) Aubert B. 1989. Le greening une maladie infectieuse des agrumes dorigine bactérienne transmise par des homoptères psyllidés Stratégies de lutte développées à lîle de la Réunion, Circonstances épidémiologiques en Afrique Asie et modalités dintervention. (THÈSE DE DOCTORAT EN SCIENCES AGRONOMIQUES Spécialité : Sciences de la Production Végétale). INRA Bordeaux : Université Bordeaux 2 Aubert B., Grisoni M., et Villemin M. 1996. A Case Study of Huanglongbing (Greening) Control in Reunion. 9(1), p. 3. Bertaux C. 2015. Mise en place de la spectroscopie proche infrarouge selon les approches Quality By Design et Lean Six Sigma pour le pilotage en ligne de lhumidité dune poudre. (THÈSE DE DOCTORAT EN SCIENCES PHARMACEUTIQUE). Bordeaux : Université Bordeaux 2 U.F.R. DES SCIENCES PHARMACEUTIQUES Borkovec M. et Madin N. 2019. ggparty: ggplot Visualizations for the partykit Package. Disponible sur : https://CRAN.R-project.org/package=ggparty Bové J.M. 2006. HUANGLONGBING: A DESTRUCTIVE, NEWLY-EMERGING, CENTURY·OLD DISEASE OF CITRUS. 88(1), p. 737. Comar A. 2013. Etude des interactions feuille/lumière et de leurs implications pour le phénotypage haut débit au champ. (THÈSE DE DOCTORAT EN SCIENCES AGRONOMIQUES Spécialité : Sciences de la Production Végétale). Avignon : Université dAvignon Comte A. 2013. Apport des marqueurs SSRs nucléaires, des InDel mitochondriaux et de la diversité allélique de gènes candidats pour la tolérance à la salinité. (THÈSE DE DOCTORAT EN SCIENCES AGRONOMIQUES Spécialité : Sciences de la Production Végétale). Tunis : INSTITUT NATIONAL AGRONOMIQUE DE TUNISIE Cortes C. et Vapnik V. 1995. Support-vector networks. 20(3). Disponible sur : http://link.springer.com/10.1007/BF00994018 (Consulté le 4 septembre 2020). Créquy N. 2020. Prise en compte de la structure du paysage pour la surveillance épidémiologique du HLB sur lîle de La Réunion et exploration dune nouvelle méthode de diagnostic par Spectroscopie Proche Infra-Rouge. Rennes : Agrocampus Ouest, 34 p. De Blomac F. 2014. Hyperspectral. Disponible sur : https://decryptageo.fr/hyperspectral/ (Consulté le 21 juin 2021). Deng X., Zhu Z., Yang J., Zheng Z., Huang Z., Yin X., Wei S., et Lan Y. 2020. Detection of Citrus Huanglongbing Based on Multi-Input Neural Network Model of UAV Hyperspectral Remote Sensing. 12(17). Disponible sur : https://www.mdpi.com/2072-4292/12/17/2678 (Consulté le 9 avril 2021). Equipe Artists - UR AïDA C. 2021. METEOR. Disponible sur : https://smartis.re/METEOR (Consulté le 8 avril 2021). Gottwald T.R. 2010. Current Epidemiological Understanding of Citrus Huanglongbing. 48(1), p. 39119. Gottwald T.R. 1989. Preliminary Analysis of Citrus Greening (Huanglungbin) Epidemics in the Peoples Republic of China and French Reunion Island. 79(6). Disponible sur : http://www.apsnet.org/publications/phytopathology/backissues/Documents/1989Abstracts/Phyto79_687.htm (Consulté le 5 mars 2021). Guilloteau C. 2018. Utilisation de la connaissance du paysage agricole pour laccompagnement des réseaux dépidémio-surveillance : application au greening des agrumes à la Réunion. Paris : AgroParisTech, 39 p. Gutierrez A.P. et Ponti L. 2013. Prospective Analysis of the Geographic Distribution and Relative Abundance of Asian Citrus Psyllid (Hemiptera: Liviidae) and Citrus Greening Disease in North America and the Mediterranean Basin. 96(4). Disponible sur : http://www.bioone.org/doi/abs/10.1653/024.096.0417 (Consulté le 6 avril 2021). Knaus J. 2015. snowfall: Easier cluster computing (based on snow). Disponible sur : https://CRAN.R-project.org/package=snowfall Leung J. 2014. La production fruitière à La Réunion. Liaw A. et Wiener M. 2002. Classification and Regression by randomForest. 2(3), p. 1822. Disponible sur : https://CRAN.R-project.org/doc/Rnews/ Mevik B.-H., Wehrens R., et Liland K.H. 2020. pls: Partial Least Squares and Principal Component Regression. Disponible sur : https://CRAN.R-project.org/package=pls Meyer D., Dimitriadou E., Hornik K., Weingessel A., et Leisch F. 2020. e1071: Misc Functions of the Department of Statistics, Probability Theory Group (Formerly: E1071), TU Wien. Disponible sur : https://CRAN.R-project.org/package=e1071 Mishra A., Ehsani R., Won Suk Lee, et Gene Albrigo. 2007. Spectral Characteristics of Citrus Greening (Huanglongbing). Dans : 2007 Minneapolis, Minnesota, June 17-20, 2007. Minneapolis : American Society of Agricultural; Biological Engineers, p. 10. Disponible sur : http://elibrary.asabe.org/abstract.asp?JID=5&amp;AID=24163&amp;CID=min2007&amp;T=1 (Consulté le 18 avril 2021). Morillon C. 2020. Huanglongbing the citrus disease. Moriya É.A.S., Imai N.N., Tommaselli A.M.G., Berveglieri A., Honkavaara E., Soares M.A., et Marino M. 2019. DETECTING CITRUS HUANGLONGBING IN BRAZILIAN ORCHARDS USING HYPERSPECTRAL AERIAL IMAGES. XLII-2/W13. Disponible sur : https://www.int-arch-photogramm-remote-sens-spatial-inf-sci.net/XLII-2-W13/1881/2019/ (Consulté le 19 avril 2021). Moutarde F. 2017. Arbres de Décision et Forêts Aléatoires., p. 20. Narouei-Khandan H.A., Halbert S.E., Worner S.P., et Bruggen A.H.C. van. 2016. Global climate suitability of citrus huanglongbing and its vector, the Asian citrus psyllid, using two correlative species distribution modeling approaches, with emphasis on the USA. 144(3). Disponible sur : http://link.springer.com/10.1007/s10658-015-0804-7 (Consulté le 28 mars 2021). R Core Team. 2021. R: A Language and Environment for Statistical Computing. Vienna, Austria : R Foundation for Statistical Computing Disponible sur : https://www.R-project.org/ Sankaran S. et Ehsani R. 2011. Visible-near infrared spectroscopy based citrus greening detection: Evaluation of spectral feature extraction techniques. 30(11). Disponible sur : https://linkinghub.elsevier.com/retrieve/pii/S0261219411002304 (Consulté le 4 septembre 2020). Sankaran S., Maja J., Buchanon S., et Ehsani R. 2013. Huanglongbing (Citrus Greening) Detection Using Visible, Near Infrared and Thermal Imaging Techniques. 13(2). Disponible sur : http://www.mdpi.com/1424-8220/13/2/2117 (Consulté le 9 avril 2021). Tenehaus H. 1999. Lapproche PLS. 47(2), p. 37. Tuszynski J. 2020. caTools: Tools: Moving Window Statistics, GIF, Base64, ROC AUC, etc. Disponible sur : https://CRAN.R-project.org/package=caTools Wang N. 2019. The Citrus Huanglongbing Crisis and Potential Solutions. 12(5). Disponible sur : https://linkinghub.elsevier.com/retrieve/pii/S1674205219301212 (Consulté le 6 avril 2021). "]]
